(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1872],{243:(e,s,r)=>{"use strict";r.d(s,{E:()=>d});var a=r(5155),t=r(4269);function d(e){let{className:s,...r}=e;return(0,a.jsx)("div",{className:(0,t.cn)("animate-pulse rounded-md bg-muted",s),...r})}},627:(e,s,r)=>{Promise.resolve().then(r.bind(r,5389))},4818:(e,s,r)=>{"use strict";r.d(s,{z:()=>d});var a=r(5155),t=r(4269);function d(e){let{title:s,description:r,children:d,className:l}=e;return(0,a.jsx)("div",{className:(0,t.cn)("mb-8 relative",l),children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"font-headline text-3xl font-bold tracking-tight md:text-4xl",children:s}),r&&(0,a.jsx)("p",{className:"mt-1 text-lg text-muted-foreground",children:r})]}),d]})})}},5142:(e,s,r)=>{"use strict";r.d(s,{p:()=>l});var a=r(5155),t=r(2115),d=r(4269);let l=t.forwardRef((e,s)=>{let{className:r,type:t,...l}=e;return(0,a.jsx)("input",{type:t,className:(0,d.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:s,...l})});l.displayName="Input"},5389:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>w});var a=r(5155),t=r(4818),d=r(6948),l=r(5142),i=r(3998),n=r(109),c=r(5212),o=r(2997),m=r(5897),x=r(8058),f=r(2619),u=r.n(f),h=r(2115),p=r(63),N=r(5894),j=r(2949),g=r(243);function v(){return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsx)(t.z,{title:"Find and Make Friends",description:"Search for friends, manage your connections, and start playing."}),(0,a.jsxs)("div",{className:"mb-8 flex gap-4",children:[(0,a.jsx)(g.E,{className:"h-10 flex-1"}),(0,a.jsx)(g.E,{className:"h-10 w-28"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g.E,{className:"h-8 w-48 mb-4"}),(0,a.jsx)("div",{className:"space-y-4",children:[void 0,void 0].map((e,s)=>(0,a.jsx)(d.Zp,{children:(0,a.jsxs)(d.Wu,{className:"p-4 flex flex-col sm:flex-row items-center gap-4",children:[(0,a.jsx)(g.E,{className:"h-24 w-24 rounded-full"}),(0,a.jsxs)("div",{className:"flex-1 space-y-2 text-center sm:text-left",children:[(0,a.jsx)(g.E,{className:"h-6 w-32"}),(0,a.jsx)(g.E,{className:"h-4 w-24"}),(0,a.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-2",children:[(0,a.jsx)(g.E,{className:"h-4 w-20"}),(0,a.jsx)(g.E,{className:"h-4 w-20"}),(0,a.jsx)(g.E,{className:"h-4 w-20"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsx)(g.E,{className:"h-4 w-40"}),(0,a.jsx)(g.E,{className:"h-10 w-36"})]})]})},s))})]})]})}function w(){let e=(0,p.useRouter)(),{toast:s}=(0,N.dj)(),{user:r,isLoading:f}=(0,j.Jd)(),{data:g,isLoading:w}=(0,j.uN)("accounts",null==r?void 0:r.uid),[y,b]=(0,h.useState)([]),[E,C]=(0,h.useState)(!0),[R,k]=(0,h.useState)("");(0,h.useEffect)(()=>{f||r||e.push("/sign-in")},[f,r,e]),(0,h.useEffect)(()=>{(async()=>{g&&g.friendIds?(g.friendIds.length>0?(C(!0),b(await (0,x.M7)(g.friendIds))):b([]),C(!1)):g&&(b([]),C(!1))})()},[g]);let F=async()=>{var e;if(!R.trim())return void s({title:"Username required",description:"Please enter a username to add a friend.",variant:"destructive"});if(!g)return;let r=await (0,x.hN)(R.trim().toLowerCase());if(!r)return void s({title:"User not found",description:'Could not find a user with the username "'.concat(R,'".'),variant:"destructive"});if(r.id===g.id)return void s({title:"Cannot add yourself",description:"You cannot add yourself as a friend.",variant:"destructive"});if(null==(e=g.friendIds)?void 0:e.includes(r.id)){s({title:"Already friends",description:"You are already friends with ".concat(r.name,".")}),k("");return}try{let e=[...g.friendIds||[],r.id];await (0,x.z0)(g.id,{friendIds:e}),b(e=>[...e,r].sort((e,s)=>e.name.localeCompare(s.name))),s({title:"Friend Added!",description:"You are now friends with ".concat(r.name,".")}),k("")}catch(e){console.error(e),s({title:"Error",description:"Failed to add friend. Please try again.",variant:"destructive"})}};return f||w||E?(0,a.jsx)(v,{}):(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsx)(t.z,{title:"Find and Make Friends",description:"Search for friends, manage your connections, and start playing."}),(0,a.jsxs)("div",{className:"mb-8 flex gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(n.A,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-muted-foreground"}),(0,a.jsx)(l.p,{id:"find-friend",placeholder:"Search by username...",className:"pl-10 pr-10",value:R,onChange:e=>k(e.target.value)}),(0,a.jsx)(c.A,{className:"absolute right-3 top-1/2 h-5 w-5 -translate-y-1/2 cursor-pointer text-muted-foreground"})]}),(0,a.jsxs)(i.$,{onClick:F,children:[(0,a.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Add Friend"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold mb-4",children:["Your Friends (",y.length,")"]}),y.length>0?(0,a.jsx)("div",{className:"space-y-4",children:y.map(e=>(0,a.jsx)(d.Zp,{children:(0,a.jsxs)(d.Wu,{className:"p-4 flex flex-col sm:flex-row items-center gap-4",children:[(0,a.jsxs)(m.eu,{className:"h-24 w-24 border-4 border-primary",children:[(0,a.jsx)(m.BK,{src:"https://picsum.photos/seed/".concat(e.id,"/200"),alt:e.name}),(0,a.jsx)(m.q5,{children:e.name.charAt(0)})]}),(0,a.jsxs)("div",{className:"flex-1 text-center sm:text-left",children:[(0,a.jsx)("h3",{className:"text-xl font-bold",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["@",e.username]}),(0,a.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-sm",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Rider's #"})," ",e.riderNumber||"N/A"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Play Wins:"})," ",e.playHistory.filter(e=>"Won"===e.status).length]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Standings:"})," ",e.mxhubStanding||"N/A"]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-center",children:"Play with this Friend Next Race"}),(0,a.jsx)(i.$,{asChild:!0,className:"w-full sm:w-auto bg-red-600 hover:bg-red-700",children:(0,a.jsx)(u(),{href:"/play",children:"Play Next Race"})})]})]})},e.id))}):(0,a.jsxs)("div",{className:"text-center py-10 rounded-lg border border-dashed",children:[(0,a.jsx)("p",{className:"text-muted-foreground",children:"You haven't added any friends yet."}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Use the search bar to find and add friends."})]})]})]})}},5897:(e,s,r)=>{"use strict";r.d(s,{BK:()=>n,eu:()=>i,q5:()=>c});var a=r(5155),t=r(2115),d=r(7870),l=r(4269);let i=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)(d.bL,{ref:s,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...t})});i.displayName=d.bL.displayName;let n=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)(d._V,{ref:s,className:(0,l.cn)("aspect-square h-full w-full",r),...t})});n.displayName=d._V.displayName;let c=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)(d.H4,{ref:s,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...t})});c.displayName=d.H4.displayName},6948:(e,s,r)=>{"use strict";r.d(s,{BT:()=>c,Wu:()=>o,ZB:()=>n,Zp:()=>l,aR:()=>i,wL:()=>m});var a=r(5155),t=r(2115),d=r(4269);let l=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,d.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...t})});l.displayName="Card";let i=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",r),...t})});i.displayName="CardHeader";let n=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,d.cn)("text-2xl font-semibold leading-none tracking-tight",r),...t})});n.displayName="CardTitle";let c=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,d.cn)("text-sm text-muted-foreground",r),...t})});c.displayName="CardDescription";let o=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,d.cn)("p-6 pt-0",r),...t})});o.displayName="CardContent";let m=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,d.cn)("flex items-center p-6 pt-0",r),...t})});m.displayName="CardFooter"}},e=>{e.O(0,[2992,7811,4909,2619,2381,5882,6301,1005,8441,1255,7358],()=>e(e.s=627)),_N_E=e.O()}]);