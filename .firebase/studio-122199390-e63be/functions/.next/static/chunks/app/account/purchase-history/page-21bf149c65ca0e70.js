(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4249],{63:(e,t,r)=>{"use strict";var n=r(7260);r.o(n,"notFound")&&r.d(t,{notFound:function(){return n.notFound}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},243:(e,t,r)=>{"use strict";r.d(t,{E:()=>a});var n=r(5155),s=r(4269);function a(e){let{className:t,...r}=e;return(0,n.jsx)("div",{className:(0,s.cn)("animate-pulse rounded-md bg-muted",t),...r})}},1647:(e,t,r)=>{"use strict";r.d(t,{E:()=>d});var n=r(5155);r(2115);var s=r(3101),a=r(4269);let l=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:t,variant:r,...s}=e;return(0,n.jsx)("div",{className:(0,a.cn)(l({variant:r}),t),...s})}},4818:(e,t,r)=>{"use strict";r.d(t,{z:()=>a});var n=r(5155),s=r(4269);function a(e){let{title:t,description:r,children:a,className:l}=e;return(0,n.jsx)("div",{className:(0,s.cn)("mb-8 relative",l),children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"font-headline text-3xl font-bold tracking-tight md:text-4xl",children:t}),r&&(0,n.jsx)("p",{className:"mt-1 text-lg text-muted-foreground",children:r})]}),a]})})}},4932:(e,t,r)=>{Promise.resolve().then(r.bind(r,5434))},5434:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var n=r(5155),s=r(2115),a=r(4818),l=r(3998),d=r(6948),i=r(7270),o=r(1647),c=r(2949),u=r(243),f=r(63),x=r(5894),h=r(8058);function m(){return(0,n.jsxs)("div",{children:[(0,n.jsx)(a.z,{title:"Purchase History",description:"Review your past Gold Coin purchases and request refunds."}),(0,n.jsx)(d.Zp,{children:(0,n.jsx)(d.Wu,{className:"p-0",children:(0,n.jsxs)(i.XI,{children:[(0,n.jsx)(i.A0,{children:(0,n.jsxs)(i.Hj,{children:[(0,n.jsx)(i.nd,{children:"Date"}),(0,n.jsx)(i.nd,{children:"Package ID"}),(0,n.jsx)(i.nd,{children:"Amount"}),(0,n.jsx)(i.nd,{children:"Price"}),(0,n.jsx)(i.nd,{children:"Status"}),(0,n.jsx)(i.nd,{className:"text-right",children:"Action"})]})}),(0,n.jsx)(i.BF,{children:[void 0,void 0,void 0].map((e,t)=>(0,n.jsxs)(i.Hj,{children:[(0,n.jsx)(i.nA,{children:(0,n.jsx)(u.E,{className:"h-5 w-24"})}),(0,n.jsx)(i.nA,{children:(0,n.jsx)(u.E,{className:"h-5 w-20"})}),(0,n.jsx)(i.nA,{children:(0,n.jsx)(u.E,{className:"h-5 w-16"})}),(0,n.jsx)(i.nA,{children:(0,n.jsx)(u.E,{className:"h-5 w-16"})}),(0,n.jsx)(i.nA,{children:(0,n.jsx)(u.E,{className:"h-6 w-24 rounded-full"})}),(0,n.jsx)(i.nA,{className:"text-right",children:(0,n.jsx)(u.E,{className:"h-9 w-28"})})]},t))})]})})})]})}function p(){let e=(0,f.useRouter)(),{toast:t}=(0,x.dj)(),{user:r,isLoading:u}=(0,c.Jd)(),{data:p,isLoading:j}=(0,c.uN)("accounts",null==r?void 0:r.uid,{listen:!0}),{data:g,isLoading:v}=(0,c.Ge)("goldCoinPurchases",["userId","==",null==r?void 0:r.uid],{listen:!0}),b=async e=>{if(p){if(p.balances.gold<e.amount)return void t({title:"Cannot Request Refund",description:"Your current balance is less than the purchase amount. Coins may have been spent.",variant:"destructive"});try{await (0,h.BE)(e.id,{status:"Refund Requested"}),t({title:"Refund Requested",description:"Your refund request has been submitted for review."})}catch(e){console.error(e),t({title:"Error",description:"Failed to submit refund request. Please try again.",variant:"destructive"})}}},N=(0,s.useMemo)(()=>g?[...g].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()):[],[g]);return u||j||v?(0,n.jsx)(m,{}):r||u?(0,n.jsxs)("div",{children:[(0,n.jsx)(a.z,{title:"Purchase History",description:"Review your past Gold Coin purchases and request refunds."}),(0,n.jsx)(d.Zp,{children:(0,n.jsx)(d.Wu,{className:"p-0",children:(0,n.jsxs)(i.XI,{children:[(0,n.jsx)(i.A0,{children:(0,n.jsxs)(i.Hj,{children:[(0,n.jsx)(i.nd,{children:"Date"}),(0,n.jsx)(i.nd,{children:"Package ID"}),(0,n.jsx)(i.nd,{children:"Amount (GC)"}),(0,n.jsx)(i.nd,{children:"Price (USD)"}),(0,n.jsx)(i.nd,{children:"Status"}),(0,n.jsx)(i.nd,{className:"text-right",children:"Action"})]})}),(0,n.jsx)(i.BF,{children:N.length>0?N.map(e=>{var t;let r="Completed"===e.status&&(null!=(t=null==p?void 0:p.balances.gold)?t:0)>=e.amount;return(0,n.jsxs)(i.Hj,{children:[(0,n.jsx)(i.nA,{children:new Date(e.date).toLocaleDateString()}),(0,n.jsx)(i.nA,{children:e.packageId}),(0,n.jsx)(i.nA,{children:e.amount.toLocaleString()}),(0,n.jsxs)(i.nA,{children:["$",e.price.toFixed(2)]}),(0,n.jsx)(i.nA,{children:(0,n.jsx)(o.E,{variant:"Refunded"===e.status?"destructive":"Refund Requested"===e.status?"secondary":"default",children:e.status})}),(0,n.jsx)(i.nA,{className:"text-right",children:"Completed"===e.status&&(0,n.jsx)(l.$,{size:"sm",onClick:()=>b(e),disabled:!r,title:r?"Request a refund for this purchase.":"Your current balance is too low to refund this purchase.",children:"Request Refund"})})]},e.id)}):(0,n.jsx)(i.Hj,{children:(0,n.jsx)(i.nA,{colSpan:6,className:"text-center h-24",children:"You have no Gold Coin purchase history."})})})]})})})]}):(e.push("/sign-in"),(0,n.jsx)(m,{}))}},6948:(e,t,r)=>{"use strict";r.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>i,Zp:()=>l,aR:()=>d,wL:()=>u});var n=r(5155),s=r(2115),a=r(4269);let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});l.displayName="Card";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...s})});d.displayName="CardHeader";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});i.displayName="CardTitle";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...s})});o.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",r),...s})});c.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r),...s})});u.displayName="CardFooter"},7129:(e,t,r)=>{"use strict";r.d(t,{DX:()=>d,TL:()=>l});var n=r(2115);function s(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}var a=r(5155);function l(e){let t=function(e){let t=n.forwardRef((e,t)=>{let{children:r,...a}=e;if(n.isValidElement(r)){var l;let e,d,i=(l=r,(d=(e=Object.getOwnPropertyDescriptor(l.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?l.ref:(d=(e=Object.getOwnPropertyDescriptor(l,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?l.props.ref:l.props.ref||l.ref),o=function(e,t){let r={...t};for(let n in t){let s=e[n],a=t[n];/^on[A-Z]/.test(n)?s&&a?r[n]=(...e)=>{let t=a(...e);return s(...e),t}:s&&(r[n]=s):"style"===n?r[n]={...s,...a}:"className"===n&&(r[n]=[s,a].filter(Boolean).join(" "))}return{...e,...r}}(a,r.props);return r.type!==n.Fragment&&(o.ref=t?function(...e){return t=>{let r=!1,n=e.map(e=>{let n=s(e,t);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let t=0;t<n.length;t++){let r=n[t];"function"==typeof r?r():s(e[t],null)}}}}(t,i):i),n.cloneElement(r,o)}return n.Children.count(r)>1?n.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),r=n.forwardRef((e,r)=>{let{children:s,...l}=e,d=n.Children.toArray(s),i=d.find(o);if(i){let e=i.props.children,s=d.map(t=>t!==i?t:n.Children.count(e)>1?n.Children.only(null):n.isValidElement(e)?e.props.children:null);return(0,a.jsx)(t,{...l,ref:r,children:n.isValidElement(e)?n.cloneElement(e,void 0,s):null})}return(0,a.jsx)(t,{...l,ref:r,children:s})});return r.displayName=`${e}.Slot`,r}var d=l("Slot"),i=Symbol("radix.slottable");function o(e){return n.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===i}},7270:(e,t,r)=>{"use strict";r.d(t,{A0:()=>d,BF:()=>i,Hj:()=>o,XI:()=>l,nA:()=>u,nd:()=>c});var n=r(5155),s=r(2115),a=r(4269);let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{className:"relative w-full overflow-auto",children:(0,n.jsx)("table",{ref:t,className:(0,a.cn)("w-full caption-bottom text-sm",r),...s})})});l.displayName="Table";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("thead",{ref:t,className:(0,a.cn)("[&_tr]:border-b",r),...s})});d.displayName="TableHeader";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("tbody",{ref:t,className:(0,a.cn)("[&_tr:last-child]:border-0",r),...s})});i.displayName="TableBody",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("tfoot",{ref:t,className:(0,a.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...s})}).displayName="TableFooter";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("tr",{ref:t,className:(0,a.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...s})});o.displayName="TableRow";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("th",{ref:t,className:(0,a.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...s})});c.displayName="TableHead";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("td",{ref:t,className:(0,a.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...s})});u.displayName="TableCell",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("caption",{ref:t,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",r),...s})}).displayName="TableCaption"}},e=>{e.O(0,[2992,7811,4909,2381,6301,1005,8441,1255,7358],()=>e(e.s=4932)),_N_E=e.O()}]);