(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1872],{243:(e,s,t)=>{"use strict";t.d(s,{E:()=>d});var r=t(5155),a=t(4269);function d(e){let{className:s,...t}=e;return(0,r.jsx)("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",s),...t})}},627:(e,s,t)=>{Promise.resolve().then(t.bind(t,5389))},4818:(e,s,t)=>{"use strict";t.d(s,{z:()=>a});var r=t(5155);function a(e){let{title:s,description:t,children:a}=e;return(0,r.jsx)("div",{className:"mb-8 relative",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"font-headline text-3xl font-bold tracking-tight md:text-4xl",children:s}),t&&(0,r.jsx)("p",{className:"mt-1 text-lg text-muted-foreground",children:t})]}),a]})})}},5142:(e,s,t)=>{"use strict";t.d(s,{p:()=>i});var r=t(5155),a=t(2115),d=t(4269);let i=a.forwardRef((e,s)=>{let{className:t,type:a,...i}=e;return(0,r.jsx)("input",{type:a,className:(0,d.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...i})});i.displayName="Input"},5389:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>b});var r=t(5155),a=t(4818),d=t(6948),i=t(5142),n=t(3998),l=t(109),c=t(5212),o=t(2997),x=t(5897),u=t(8058),m=t(2619),f=t.n(m),h=t(2115),p=t(63),j=t(5894),N=t(7820),g=t(243);function v(){return(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsx)(a.z,{title:"Find and Make Friends",description:"Search for friends, manage your connections, and start betting."}),(0,r.jsxs)("div",{className:"mb-8 flex gap-4",children:[(0,r.jsx)(g.E,{className:"h-10 flex-1"}),(0,r.jsx)(g.E,{className:"h-10 w-28"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(g.E,{className:"h-8 w-48 mb-4"}),(0,r.jsx)("div",{className:"space-y-4",children:[void 0,void 0].map((e,s)=>(0,r.jsx)(d.Zp,{children:(0,r.jsxs)(d.Wu,{className:"p-4 flex flex-col sm:flex-row items-center gap-4",children:[(0,r.jsx)(g.E,{className:"h-24 w-24 rounded-full"}),(0,r.jsxs)("div",{className:"flex-1 space-y-2 text-center sm:text-left",children:[(0,r.jsx)(g.E,{className:"h-6 w-32"}),(0,r.jsx)(g.E,{className:"h-4 w-24"}),(0,r.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-2",children:[(0,r.jsx)(g.E,{className:"h-4 w-20"}),(0,r.jsx)(g.E,{className:"h-4 w-20"}),(0,r.jsx)(g.E,{className:"h-4 w-20"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsx)(g.E,{className:"h-4 w-40"}),(0,r.jsx)(g.E,{className:"h-10 w-36"})]})]})},s))})]})]})}function b(){let e=(0,p.useRouter)(),{toast:s}=(0,j.dj)(),{user:t,isLoading:m}=(0,N.Jd)(),{data:g,isLoading:b}=(0,N.uN)("accounts",(null==t?void 0:t.uid)||"---"),[w,y]=(0,h.useState)([]),[E,k]=(0,h.useState)(!0),[A,C]=(0,h.useState)("");(0,h.useEffect)(()=>{m||t||e.push("/sign-in")},[m,t,e]),(0,h.useEffect)(()=>{(async()=>{g&&g.friendIds?(g.friendIds.length>0?(k(!0),y(await (0,u.M7)(g.friendIds))):y([]),k(!1)):g&&(y([]),k(!1))})()},[g]);let F=async()=>{var e;if(!A.trim())return void s({title:"Username required",description:"Please enter a username to add a friend.",variant:"destructive"});if(!g)return;let t=await (0,u.hN)(A.trim().toLowerCase());if(!t)return void s({title:"User not found",description:'Could not find a user with the username "'.concat(A,'".'),variant:"destructive"});if(t.id===g.id)return void s({title:"Cannot add yourself",description:"You cannot add yourself as a friend.",variant:"destructive"});if(null==(e=g.friendIds)?void 0:e.includes(t.id)){s({title:"Already friends",description:"You are already friends with ".concat(t.name,".")}),C("");return}try{let e=[...g.friendIds||[],t.id];await (0,u.z0)(g.id,{friendIds:e}),y(e=>[...e,t].sort((e,s)=>e.name.localeCompare(s.name))),s({title:"Friend Added!",description:"You are now friends with ".concat(t.name,".")}),C("")}catch(e){console.error(e),s({title:"Error",description:"Failed to add friend. Please try again.",variant:"destructive"})}};return m||b||E?(0,r.jsx)(v,{}):(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsx)(a.z,{title:"Find and Make Friends",description:"Search for friends, manage your connections, and start betting."}),(0,r.jsxs)("div",{className:"mb-8 flex gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(l.A,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-muted-foreground"}),(0,r.jsx)(i.p,{id:"find-friend",placeholder:"Search by username...",className:"pl-10 pr-10",value:A,onChange:e=>C(e.target.value)}),(0,r.jsx)(c.A,{className:"absolute right-3 top-1/2 h-5 w-5 -translate-y-1/2 cursor-pointer text-muted-foreground"})]}),(0,r.jsxs)(n.$,{onClick:F,children:[(0,r.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Add Friend"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold mb-4",children:["Your Friends (",w.length,")"]}),w.length>0?(0,r.jsx)("div",{className:"space-y-4",children:w.map(e=>(0,r.jsx)(d.Zp,{children:(0,r.jsxs)(d.Wu,{className:"p-4 flex flex-col sm:flex-row items-center gap-4",children:[(0,r.jsxs)(x.eu,{className:"h-24 w-24 border-4 border-primary",children:[(0,r.jsx)(x.BK,{src:"https://picsum.photos/seed/".concat(e.id,"/200"),alt:e.name}),(0,r.jsx)(x.q5,{children:e.name.charAt(0)})]}),(0,r.jsxs)("div",{className:"flex-1 text-center sm:text-left",children:[(0,r.jsx)("h3",{className:"text-xl font-bold",children:e.name}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["@",e.username]}),(0,r.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-sm",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Rider's #"})," ",e.riderNumber||"N/A"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Bet Wins:"})," ",e.betHistory.filter(e=>"Won"===e.status).length]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Standings:"})," ",e.mxhubStanding||"N/A"]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-center",children:"Bet with this Friend Next Race"}),(0,r.jsx)(n.$,{asChild:!0,className:"w-full sm:w-auto bg-red-600 hover:bg-red-700",children:(0,r.jsx)(f(),{href:"/betting",children:"Bet Next Race"})})]})]})},e.id))}):(0,r.jsxs)("div",{className:"text-center py-10 rounded-lg border border-dashed",children:[(0,r.jsx)("p",{className:"text-muted-foreground",children:"You haven't added any friends yet."}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Use the search bar to find and add friends."})]})]})]})}},5897:(e,s,t)=>{"use strict";t.d(s,{BK:()=>l,eu:()=>n,q5:()=>c});var r=t(5155),a=t(2115),d=t(7870),i=t(4269);let n=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(d.bL,{ref:s,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...a})});n.displayName=d.bL.displayName;let l=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(d._V,{ref:s,className:(0,i.cn)("aspect-square h-full w-full",t),...a})});l.displayName=d._V.displayName;let c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(d.H4,{ref:s,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...a})});c.displayName=d.H4.displayName}},e=>{e.O(0,[2992,3644,4909,4193,2619,5882,4944,8441,1255,7358],()=>e(e.s=627)),_N_E=e.O()}]);